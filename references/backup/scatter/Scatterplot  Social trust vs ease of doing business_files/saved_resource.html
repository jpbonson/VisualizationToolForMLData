<!DOCTYPE html>
<!-- saved from url=(0080)http://bl.ocks.org/nsonnad/raw/4481531/dd320c8ca9a783dfa5bcf2e7907e39674272aae5/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Trust and Business</title>
    <script type="text/javascript" src="d3.v3.min.js"></script>
  <script src="jquery-1.8.3.min.js" type="text/javascript" charset="utf-8"></script><style type="text/css"></style>
	<script src="jquery.tipsy.js" type="text/javascript" charset="utf-8"></script>
	<link rel="stylesheet" href="tipsy.css" type="text/css" title="no title" charset="utf-8">
<style type="text/css">
	.axis path,
	.axis line {
	  fill: none;
	  stroke: #000;
	  shape-rendering: crispEdges;
	  opacity: 1;
	}

	.axis text { font-size:10px; }

	body { font: 12px sans-serif; }
	.circles { opacity: .5; }

	.tipsy { font-size:11px; margin-top:-10px;}

	.guide line {
	  fill: none;
	  stroke: #000;
	  shape-rendering: crispEdges;
	  opacity: 0;
	}
</style>
</head>
<body marginwidth="0" marginheight="0">
<div id="chart">

<script type="text/javascript">
	// set the stage
	var margin = {t:30, r:20, b:20, l:40 },
		w = 600 - margin.l - margin.r,
		h = 500 - margin.t - margin.b,
		x = d3.scale.linear().range([0, w]),
		y = d3.scale.linear().range([h - 60, 0]),
		//colors that will reflect geographical regions
		color = d3.scale.category10();

	var svg = d3.select("#chart").append("svg")
		.attr("width", w + margin.l + margin.r)
		.attr("height", h + margin.t + margin.b);

	// set axes, as well as details on their ticks
	var xAxis = d3.svg.axis()
		.scale(x)
		.ticks(20)
		.tickSubdivide(true)
		.tickSize(6, 3, 0)
		.orient("bottom");

	var yAxis = d3.svg.axis()
		.scale(y)
		.ticks(20)
		.tickSubdivide(true)
		.tickSize(6, 3, 0)
		.orient("left");

	// group that will contain all of the plots
	var groups = svg.append("g").attr("transform", "translate(" + margin.l + "," + margin.t + ")");

	// array of the regions, used for the legend
	var regions = ["Asia", "Europe", "Middle East", "N. America", "S. America", "Sub-Saharan Africa"]


// bring in the data, and do everything that is data-driven
d3.csv("trust-business.csv", function(data) {

	// sort data alphabetically by region, so that the colors match with legend
	data.sort(function(a, b) { return d3.ascending(a.region, b.region); })
	console.log(data)

	var x0 = Math.max(-d3.min(data, function(d) { return d.trust; }), d3.max(data, function(d) { return d.trust; }));
	x.domain([-100, 100]);
	y.domain([180, 0])

	// style the circles, set their locations based on data
	var circles =
	groups.selectAll("circle")
		.data(data)
	  .enter().append("circle")
	  .attr("class", "circles")
	  .attr({
	    cx: function(d) { return x(+d.trust); },
	    cy: function(d) { return y(+d.business); },
	    r: 8,
	    id: function(d) { return d.country; }
	  })
		.style("fill", function(d) { return color(d.region); });

	// what to do when we mouse over a bubble
	var mouseOn = function() { 
		var circle = d3.select(this);

	// transition to increase size/opacity of bubble
		circle.transition()
		.duration(800).style("opacity", 1)
		.attr("r", 16).ease("elastic");

		// append lines to bubbles that will be used to show the precise data points.
		// translate their location based on margins
		svg.append("g")
			.attr("class", "guide")
		.append("line")
			.attr("x1", circle.attr("cx"))
			.attr("x2", circle.attr("cx"))
			.attr("y1", +circle.attr("cy") + 26)
			.attr("y2", h - margin.t - margin.b)
			.attr("transform", "translate(40,20)")
			.style("stroke", circle.style("fill"))
			.transition().delay(200).duration(400).styleTween("opacity", 
						function() { return d3.interpolate(0, .5); })

		svg.append("g")
			.attr("class", "guide")
		.append("line")
			.attr("x1", +circle.attr("cx") - 16)
			.attr("x2", 0)
			.attr("y1", circle.attr("cy"))
			.attr("y2", circle.attr("cy"))
			.attr("transform", "translate(40,30)")
			.style("stroke", circle.style("fill"))
			.transition().delay(200).duration(400).styleTween("opacity", 
						function() { return d3.interpolate(0, .5); });

	// function to move mouseover item to front of SVG stage, in case
	// another bubble overlaps it
		d3.selection.prototype.moveToFront = function() { 
		  return this.each(function() { 
			this.parentNode.appendChild(this); 
		  }); 
		};

	// skip this functionality for IE9, which doesn't like it
		if (!$.browser.msie) {
			circle.moveToFront();	
			}
	};
	// what happens when we leave a bubble?
	var mouseOff = function() {
		var circle = d3.select(this);

		// go back to original size and opacity
		circle.transition()
		.duration(800).style("opacity", .5)
		.attr("r", 8).ease("elastic");

		// fade out guide lines, then remove them
		d3.selectAll(".guide").transition().duration(100).styleTween("opacity", 
						function() { return d3.interpolate(.5, 0); })
			.remove()
	};

	// run the mouseon/out functions
	circles.on("mouseover", mouseOn);
	circles.on("mouseout", mouseOff);

	// tooltips (using jQuery plugin tipsy)
	circles.append("title")
			.text(function(d) { return d.country; })

	$(".circles").tipsy({ gravity: 's', });

	// the legend color guide
	var legend = svg.selectAll("rect")
			.data(regions)
		.enter().append("rect")
		.attr({
		  x: function(d, i) { return (40 + i*80); },
		  y: h,
		  width: 25,
		  height: 12
		})
		.style("fill", function(d) { return color(d); });


	// legend labels	
		svg.selectAll("text")
			.data(regions)
		.enter().append("text")
		.attr({
		x: function(d, i) { return (40 + i*80); },
		y: h + 24,
		})
		.text(function(d) { return d; });

	// draw axes and axis labels
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(" + margin.l + "," + (h - 60 + margin.t) + ")")
		.call(xAxis);

	svg.append("g")
		.attr("class", "y axis")
		.attr("transform", "translate(" + margin.l + "," + margin.t + ")")
		.call(yAxis);

	svg.append("text")
		.attr("class", "x label")
		.attr("text-anchor", "end")
		.attr("x", w + 50)
		.attr("y", h - margin.t - 5)
		.text("others in society seen as trustworthy*");

	svg.append("text")
		.attr("class", "y label")
		.attr("text-anchor", "end")
		.attr("x", -20)
		.attr("y", 45)
		.attr("dy", ".75em")
		.attr("transform", "rotate(-90)")
		.text("ease of doing business (rank)");
	});

</script><svg width="600" height="500"><g transform="translate(40,30)"><circle class="circles" cx="248.4" cy="17.333333333333314" r="8" id="South Korea" original-title="" style="fill: rgb(31, 119, 180);"><original-title>South Korea</original-title></circle><circle class="circles" cx="480.6" cy="197.16666666666666" r="8" id="China" original-title="" style="fill: rgb(31, 119, 180);"><original-title>China</original-title></circle><circle class="circles" cx="337.5" cy="231.83333333333334" r="8" id="Pakistan" original-title="" style="fill: rgb(31, 119, 180);"><original-title>Pakistan</original-title></circle><circle class="circles" cx="288.90000000000003" cy="286" r="8" id="India" original-title="" style="fill: rgb(31, 119, 180);"><original-title>India</original-title></circle><circle class="circles" cx="318.59999999999997" cy="277.33333333333337" r="8" id="Indonesia" original-title="" style="fill: rgb(31, 119, 180);"><original-title>Indonesia</original-title></circle><circle class="circles" cx="226.79999999999998" cy="51.999999999999986" r="8" id="Japan" original-title="" style="fill: rgb(31, 119, 180);"><original-title>Japan</original-title></circle><circle class="circles" cx="229.5" cy="279.5" r="8" id="Bangladesh" original-title="" style="fill: rgb(31, 119, 180);"><original-title>Bangladesh</original-title></circle><circle class="circles" cx="305.09999999999997" cy="25.999999999999993" r="8" id="Malaysia" original-title="" style="fill: rgb(31, 119, 180);"><original-title>Malaysia</original-title></circle><circle class="circles" cx="207.9" cy="73.66666666666667" r="8" id="France" original-title="" style="fill: rgb(255, 127, 14);"><original-title>France</original-title></circle><circle class="circles" cx="280.8" cy="43.33333333333335" r="8" id="Germany" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Germany</original-title></circle><circle class="circles" cx="248.4" cy="296.8333333333333" r="8" id="Ukraine" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Ukraine</original-title></circle><circle class="circles" cx="283.5" cy="242.66666666666666" r="8" id="Russia" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Russia</original-title></circle><circle class="circles" cx="197.1" cy="153.83333333333334" r="8" id="Turkey" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Turkey</original-title></circle><circle class="circles" cx="224.1" cy="99.66666666666666" r="8" id="Slovakia" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Slovakia</original-title></circle><circle class="circles" cx="351" cy="15.166666666666655" r="8" id="Britain" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Britain</original-title></circle><circle class="circles" cx="207.9" cy="95.33333333333334" r="8" id="Spain" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Spain</original-title></circle><circle class="circles" cx="491.40000000000003" cy="28.166666666666654" r="8" id="Sweden" original-title="" style="fill: rgb(255, 127, 14);"><original-title>Sweden</original-title></circle><circle class="circles" cx="116.1" cy="249.16666666666666" r="8" id="Lebanon" original-title="" style="fill: rgb(44, 160, 44);"><original-title>Lebanon</original-title></circle><circle class="circles" cx="275.4" cy="229.66666666666669" r="8" id="Jordan" original-title="" style="fill: rgb(44, 160, 44);"><original-title>Jordan</original-title></circle><circle class="circles" cx="243" cy="210.16666666666666" r="8" id="Morocco" original-title="" style="fill: rgb(44, 160, 44);"><original-title>Morocco</original-title></circle><circle class="circles" cx="186.29999999999998" cy="82.33333333333334" r="8" id="Israel" original-title="" style="fill: rgb(44, 160, 44);"><original-title>Israel</original-title></circle><circle class="circles" cx="326.7" cy="236.16666666666669" r="8" id="Egypt" original-title="" style="fill: rgb(44, 160, 44);"><original-title>Egypt</original-title></circle><circle class="circles" cx="64.8" cy="177.66666666666669" r="8" id="Kuwait" original-title="" style="fill: rgb(44, 160, 44);"><original-title>Kuwait</original-title></circle><circle class="circles" cx="302.40000000000003" cy="8.666666666666679" r="8" id="United States" original-title="" style="fill: rgb(214, 39, 40);"><original-title>United States</original-title></circle><circle class="circles" cx="129.6" cy="281.6666666666667" r="8" id="Brazil" original-title="" style="fill: rgb(148, 103, 189);"><original-title>Brazil</original-title></circle><circle class="circles" cx="118.8" cy="93.16666666666669" r="8" id="Peru" original-title="" style="fill: rgb(148, 103, 189);"><original-title>Peru</original-title></circle><circle class="circles" cx="118.8" cy="80.16666666666669" r="8" id="Chile" original-title="" style="fill: rgb(148, 103, 189);"><original-title>Chile</original-title></circle><circle class="circles" cx="194.4" cy="364" r="8" id="Argentina" original-title="" style="fill: rgb(148, 103, 189);"><original-title>Argentina</original-title></circle><circle class="circles" cx="151.20000000000002" cy="335.83333333333337" r="8" id="Bolivia" original-title="" style="fill: rgb(148, 103, 189);"><original-title>Bolivia</original-title></circle><circle class="circles" cx="264.6" cy="390" r="8" id="Venezuela" original-title="" style="fill: rgb(148, 103, 189);"><original-title>Venezuela</original-title></circle><circle class="circles" cx="186.29999999999998" cy="84.5" r="8" id="South Africa" original-title="" style="fill: rgb(140, 86, 75);"><original-title>South Africa</original-title></circle><circle class="circles" cx="121.5" cy="283.83333333333337" r="8" id="Nigeria" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Nigeria</original-title></circle><circle class="circles" cx="226.79999999999998" cy="327.1666666666667" r="8" id="Mali" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Mali</original-title></circle><circle class="circles" cx="35.1" cy="262.1666666666667" r="8" id="Kenya" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Kenya</original-title></circle><circle class="circles" cx="121.5" cy="359.6666666666667" r="8" id="Senegal" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Senegal</original-title></circle><circle class="circles" cx="232.2" cy="383.5" r="8" id="Côte d&#39;Ivoire" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Côte d'Ivoire</original-title></circle><circle class="circles" cx="99.9" cy="260.00000000000006" r="8" id="Uganda" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Uganda</original-title></circle><circle class="circles" cx="256.5" cy="275.16666666666663" r="8" id="Ethiopia" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Ethiopia</original-title></circle><circle class="circles" cx="180.9" cy="290.3333333333333" r="8" id="Tanzania" original-title="" style="fill: rgb(140, 86, 75);"><original-title>Tanzania</original-title></circle><circle class="circles" cx="221.39999999999998" cy="140.83333333333334" r="8" id="Czech Rep." original-title="" style="fill: rgb(255, 127, 14); opacity: 0.5;"><original-title>Czech Rep.</original-title></circle><circle class="circles" cx="199.8" cy="138.66666666666666" r="8" id="Ghana" original-title="" style="fill: rgb(140, 86, 75); opacity: 0.5;"><original-title>Ghana</original-title></circle><circle class="circles" cx="199.8" cy="158.16666666666666" r="8" id="Italy" original-title="" style="fill: rgb(255, 127, 14); opacity: 0.5;"><original-title>Italy</original-title></circle><circle class="circles" cx="245.70000000000002" cy="143" r="8" id="Bulgaria" original-title="" style="fill: rgb(255, 127, 14); opacity: 0.5;"><original-title>Bulgaria</original-title></circle><circle class="circles" cx="251.10000000000002" cy="119.16666666666667" r="8" id="Poland" original-title="" style="fill: rgb(255, 127, 14); opacity: 0.5;"><original-title>Poland</original-title></circle><circle class="circles" cx="253.79999999999998" cy="104.00000000000001" r="8" id="Mexico" original-title="" style="fill: rgb(214, 39, 40); opacity: 0.5;"><original-title>Mexico</original-title></circle><circle class="circles" cx="396.9" cy="36.833333333333336" r="8" id="Canada" original-title="" style="fill: rgb(214, 39, 40); opacity: 0.5;"><original-title>Canada</original-title></circle></g><rect x="40" y="450" width="25" height="12" style="fill: rgb(31, 119, 180);"></rect><rect x="120" y="450" width="25" height="12" style="fill: rgb(255, 127, 14);"></rect><rect x="200" y="450" width="25" height="12" style="fill: rgb(44, 160, 44);"></rect><rect x="280" y="450" width="25" height="12" style="fill: rgb(214, 39, 40);"></rect><rect x="360" y="450" width="25" height="12" style="fill: rgb(148, 103, 189);"></rect><rect x="440" y="450" width="25" height="12" style="fill: rgb(140, 86, 75);"></rect><text x="40" y="474">Asia</text><text x="120" y="474">Europe</text><text x="200" y="474">Middle East</text><text x="280" y="474">N. America</text><text x="360" y="474">S. America</text><text x="440" y="474">Sub-Saharan Africa</text><g class="x axis" transform="translate(40,420)"><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-100</text></g><g class="tick" transform="translate(27,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-90</text></g><g class="tick" transform="translate(54,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-80</text></g><g class="tick" transform="translate(81,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-70</text></g><g class="tick" transform="translate(108,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-60</text></g><g class="tick" transform="translate(135,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-50</text></g><g class="tick" transform="translate(162,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-40</text></g><g class="tick" transform="translate(189,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-30</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-20</text></g><g class="tick" transform="translate(243,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-10</text></g><g class="tick" transform="translate(270,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(297,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">10</text></g><g class="tick" transform="translate(324,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">20</text></g><g class="tick" transform="translate(351,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">30</text></g><g class="tick" transform="translate(378,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">40</text></g><g class="tick" transform="translate(405,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">50</text></g><g class="tick" transform="translate(432,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">60</text></g><g class="tick" transform="translate(459,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">70</text></g><g class="tick" transform="translate(486,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">80</text></g><g class="tick" transform="translate(513,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">90</text></g><g class="tick" transform="translate(540,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">100</text></g><path class="domain" d="M0,0V0H540V0"></path></g><g class="y axis" transform="translate(40,30)"><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0</text></g><g class="tick" transform="translate(0,21.666666666666675)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">10</text></g><g class="tick" transform="translate(0,43.33333333333335)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">20</text></g><g class="tick" transform="translate(0,64.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">30</text></g><g class="tick" transform="translate(0,86.66666666666666)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">40</text></g><g class="tick" transform="translate(0,108.33333333333334)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">50</text></g><g class="tick" transform="translate(0,130.00000000000003)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">60</text></g><g class="tick" transform="translate(0,151.66666666666666)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">70</text></g><g class="tick" transform="translate(0,173.33333333333331)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">80</text></g><g class="tick" transform="translate(0,195)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">90</text></g><g class="tick" transform="translate(0,216.66666666666669)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">100</text></g><g class="tick" transform="translate(0,238.33333333333334)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">110</text></g><g class="tick" transform="translate(0,260.00000000000006)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">120</text></g><g class="tick" transform="translate(0,281.6666666666667)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">130</text></g><g class="tick" transform="translate(0,303.3333333333333)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">140</text></g><g class="tick" transform="translate(0,325)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">150</text></g><g class="tick" transform="translate(0,346.66666666666663)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">160</text></g><g class="tick" transform="translate(0,368.3333333333333)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">170</text></g><g class="tick" transform="translate(0,390)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">180</text></g><path class="domain" d="M0,0H0V390H0"></path></g><text class="x label" text-anchor="end" x="590" y="415">others in society seen as trustworthy*</text><text class="y label" text-anchor="end" x="-20" y="45" dy=".75em" transform="rotate(-90)">ease of doing business (rank)</text></svg>

</div>

</body></html>